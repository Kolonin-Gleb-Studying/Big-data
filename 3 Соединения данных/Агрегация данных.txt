SELECT * FROM hr.employees;

SELECT  COUNT(*) FROM hr.employees;

SELECT
    round(AVG(salary), 3)
FROM hr.employees;

-- В SELECT не может быть одновременно как агрегационных полей, так и обычных, по примеру
-- SELECT
--     round(AVG(salary), 3),
--     first_name
-- FROM hr.employees;

-- Подзапросы

-- Поиск имён и фамилий сотрудников с макс. ЗП

SELECT 
    first_name,
    last_name
FROM hr.employees
WHERE salary = (
    SELECT max(salary) FROM hr.employees
);

-- Группировка

SELECT * FROM oe.orders;

-- Кол. заказов, сгруппированные по типу их оформления (онл или офл).
-- Позволяет посчитать кол. онл. и офл. заказов

SELECT 
    COUNT(*),
    order_mode
FROM oe.orders
GROUP BY order_mode;


-- Поиск имен и фамилий сотрудников с макс ЗП в каждом департаменте
-- 

-- Выборка макс. ЗП в каждом департаменте
SELECT 
    DEPARTMENT_ID,
    max(salary)
FROM hr.employees
GROUP BY department_id;

-- Сделаем эту выборку подзапросом

SELECT 
    t1.first_name,
    t1.last_name,
    t1.DEPARTMENT_ID
FROM hr.employees t1
INNER JOIN (
    SELECT 
        DEPARTMENT_ID,
        max(salary) as max_salary
    FROM hr.employees
    GROUP BY department_id
) t2
ON t1.department_id = t2.department_id AND t1.salary = t2.max_salary;



-- На следующей теме будет КТ по агрегации, селекты и джоины
